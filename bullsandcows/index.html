<html>
  <title>Bulls & Cows</title>
	<a href="rules\index.html">Rules</a>
	<br>
	<input type="text" id="s" minlength="4" maxlength="4" style="border:2px solid #c0c0c0">
	<button onclick="check()" id="btn" >Check</button>
	<div id="diw"></div>

	<script>

		var r;
		var rs;
		var bulls = 0;
		var cows = 0;
		var input = document.getElementById("s");

		// Execute a function when the user releases a key on the keyboard
		input.addEventListener("keyup", function(event) {

		  if (isValid()) {
		    document.getElementById("btn").disabled = false;
			document.getElementById("s").style = "border:2px solid #c0c0c0";
		  } else {
		    document.getElementById("btn").disabled = true;
			document.getElementById("s").style = "border:2px solid #ff0000";
		  }

		  // Number 13 is the "Enter" key on the keyboard
		  if (event.keyCode === 13) {
			// Cancel the default action, if needed
			event.preventDefault();
			// Trigger the button element with a click
			document.getElementById("btn").click();
		  }
		});

		window.onload = function()
		{
		  var st = "xxxx : B,C";
		  document.getElementById("diw").innerHTML += st + "<br>";

		  var isGood = false;
		  while(!isGood)
		  {
			r = Math.floor(Math.random() * (9876 + 1));
			rs = '' + r;
			if(rs.length < 4)
			{
			  rs = '0' + rs;
			  //console.log('+0');
			}
			//console.log('"' + rs + '"');
			if(rs.length == 4)
			{
			  var c0 = rs.charAt(0);
			  var c1 = rs.charAt(1);
			  var c2 = rs.charAt(2);
			  var c3 = rs.charAt(3);
			  if(c0 != c1 && c0 != c2 && c0 != c3 && c1 != c2 && c1 != c3 && c2 != c3)
			  {
			    isGood = true;
			  }
			}
			//console.log(isGood);
		  }
		}


		function isValid()
		{
			 var a = document.getElementById("s").value;
			 //document.getElementById("s").value = '';
			 //alert('"' + rs + '"');
			 //alert('"' + a + '"');
			 if(a.length == 4)
			 {
				var a0 = a.charAt(0);
				var a1 = a.charAt(1);
			    var a2 = a.charAt(2);
			    var a3 = a.charAt(3);
			    if(a0 != a1 && a0 != a2 && a0 != a3 && a1 != a2 && a1 != a3 && a2 != a3)
			    {
				  if (a0 >= '0' && a0 <= '9' && a1 >= '0' && a1 <= '9' && a2 >= '0' && a2 <= '9' && a3 >= '0' && a3 <= '9')
				  {
				    return true;
				  }
				}
			}

			return false;
		}


	    function check()
		{
			document.getElementById("btn").disabled = true;
			document.getElementById("s").style = "border:2px solid #c0c0c0";
		    if (isValid())
		    {

			  var a = document.getElementById("s").value;

			  document.getElementById("s").value = '';

			  var a0 = a.charAt(0);
		      var a1 = a.charAt(1);
			  var a2 = a.charAt(2);
			  var a3 = a.charAt(3);

			  	  var c0 = rs.charAt(0);
			      var c1 = rs.charAt(1);
			      var c3 = rs.charAt(3);
			      var c2 = rs.charAt(2);

				  bulls = 0;
				  cows = 0;

				  if (a0 == c0) {bulls += 1;}
				  if (a0 == c1) {cows += 1;}
				  if (a0 == c2) {cows += 1;}
				  if (a0 == c3) {cows += 1;}

				  if (a1 == c0) {cows += 1;}
				  if (a1 == c1) {bulls += 1;}
				  if (a1 == c2) {cows += 1;}
				  if (a1 == c3) {cows += 1;}

				  if (a2 == c0) {cows += 1;}
				  if (a2 == c1) {cows += 1;}
				  if (a2 == c2) {bulls += 1;}
				  if (a2 == c3) {cows += 1;}

				  if (a3 == c0) {cows += 1;}
				  if (a3 == c1) {cows += 1;}
				  if (a3 == c2) {cows += 1;}
				  if (a3 == c3) {bulls += 1;}


				  //var st = "code = " + rs + '\n' + "guess = " + a + '\n' + "b = " + bulls + " c = " + cows;
				  //alert(st);
				  var st = "" + a + " : " + bulls + "," + cows;

				  document.getElementById("diw").innerHTML += st + "<br>";

			 }
		}

	</script>

</html>
